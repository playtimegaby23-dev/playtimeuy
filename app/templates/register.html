{% extends "base.html" %}
{% block title %}Registro - PlayTimeUY{% endblock %}

{% block content %}
<div class="flex items-center justify-center min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black px-6">
  <div class="bg-white/20 backdrop-blur-lg border border-white/20 rounded-3xl shadow-2xl p-10 max-w-md w-full text-white animate-fadeIn">

    <h2 class="text-4xl font-extrabold mb-8 text-center tracking-wider drop-shadow-md">
      Crear cuenta en <span class="text-indigo-400">PlayTimeUY</span>
    </h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-6 space-y-3">
          {% for category, message in messages %}
            <div class="text-sm px-5 py-3 rounded-lg font-medium
              {% if category == 'danger' %}
                bg-red-600/90 text-red-100 shadow-md
              {% else %}
                bg-green-600/90 text-green-100 shadow-md
              {% endif %}"
              role="alert"
            >
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <form method="POST" class="grid grid-cols-1 gap-5" onsubmit="return validateForm()">
      <input type="text" name="full_name" placeholder="Nombre completo" required
        class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />

      <input type="text" name="username" placeholder="Nombre de usuario" required
        class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />

      <input type="email" id="email" name="email" placeholder="Correo electr√≥nico" required
        class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />

      <div class="relative">
        <input type="password" id="password" name="password" placeholder="Contrase√±a" required
          class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 pr-12 transition" />
        <button type="button" onclick="togglePassword('password')"
          class="absolute top-3 right-3 text-white hover:text-indigo-400 transition text-xl select-none">üëÅÔ∏è</button>
      </div>

      <div class="relative">
        <input type="password" id="confirm_password" name="confirm_password" placeholder="Confirmar contrase√±a" required
          class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 pr-12 transition" />
        <button type="button" onclick="togglePassword('confirm_password')"
          class="absolute top-3 right-3 text-white hover:text-indigo-400 transition text-xl select-none">üëÅÔ∏è</button>
      </div>

      <input type="date" name="dob" required
        class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />

      <input type="text" name="country" placeholder="Pa√≠s" required
        class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />

      <input type="text" name="twitter" placeholder="Twitter (opcional)"
        class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />

      <input type="text" name="instagram" placeholder="Instagram (opcional)"
        class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />

      <select name="role" required
        class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition">
        <option value="" disabled selected>Selecciona tu rol</option>
        <option value="creator">Creador/a</option>
        <option value="buyer">Comprador/a</option>
        <option value="promoter">Promotor/a</option>
      </select>

      <button type="submit"
        class="bg-indigo-600 hover:bg-indigo-700 focus:ring-4 focus:ring-indigo-400 font-semibold py-3 rounded-xl shadow-lg shadow-indigo-500/40 transition">
        Registrarme
      </button>
    </form>

    <p class="mt-8 text-center text-sm text-gray-300">
      ¬øYa ten√©s cuenta?
      <a href="{{ url_for('login') }}" class="underline text-indigo-400 hover:text-white transition">Iniciar sesi√≥n</a>
    </p>
  </div>
</div>

<style>
  @keyframes fadeIn {
    0% {
      opacity: 0;
      transform: translateY(20px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fadeIn {
    animation: fadeIn 0.7s ease-out forwards;
  }
</style>

<script>
  function togglePassword(id) {
    const input = document.getElementById(id);
    input.type = input.type === 'password' ? 'text' : 'password';
  }

  function validateForm() {
    const email = document.getElementById('email').value.trim();
    const pass = document.getElementById('password').value.trim();
    const confirm = document.getElementById('confirm_password').value.trim();

    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;

    if (!emailPattern.test(email)) {
      alert('Correo electr√≥nico inv√°lido.');
      return false;
    }

    if (pass.length < 6) {
      alert('La contrase√±a debe tener al menos 6 caracteres.');
      return false;
    }

    if (pass !== confirm) {
      alert('Las contrase√±as no coinciden.');
      return false;
    }

    return true;
  }
</script>
{% endblock %}
